{% extends "base.html" %}
{% block title %}New Activity Â· DailyNest{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">New Activity</h1>
<form method="post" class="space-y-4 max-w-2xl">
  {{ form.hidden_tag() }}
  <div>
    {{ form.title.label(class_="block text-sm mb-1") }}
    {{ form.title(class_="w-full border rounded-lg p-2") }}
  </div>
  <div>
    {{ form.description.label(class_="block text-sm mb-1") }}
    {{ form.description(class_="w-full border rounded-lg p-2", rows="5") }}
  </div>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div>{{ form.mood.label(class_="block text-sm mb-1") }}{{ form.mood(class_="w-full border rounded-lg p-2") }}</div>
    <div>{{ form.category.label(class_="block text-sm mb-1") }}{{ form.category(class_="w-full border rounded-lg p-2") }}</div>
    <div class="flex items-center gap-2">{{ form.is_public() }} {{ form.is_public.label(class_="text-sm") }}</div>
  </div>

  <div class="p-4 border rounded-xl bg-white space-y-3">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>{{ form.location_text.label(class_="block text-sm mb-1") }}{{ form.location_text(class_="w-full border rounded-lg p-2") }}</div>
      <div>{{ form.latitude.label(class_="block text-sm mb-1") }}{{ form.latitude(class_="w-full border rounded-lg p-2") }}</div>
      <div>{{ form.longitude.label(class_="block text-sm mb-1") }}{{ form.longitude(class_="w-full border rounded-lg p-2") }}</div>
    </div>
    <button type="button" id="detect" class="px-3 py-1.5 rounded-lg border">Use my current location</button>
    <p class="text-xs text-gray-500">This uses your browser geolocation (if you allow it).</p>
  </div>

  <button class="px-4 py-2 rounded-lg bg-indigo-600 text-white">Post Activity</button>
</form>
{% endblock %}
{% block scripts %}
<script>
document.getElementById('detect').addEventListener('click', () => {
  if (!navigator.geolocation) return alert('Geolocation not supported');
  navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude.toFixed(6);
    const lng = pos.coords.longitude.toFixed(6);
    document.getElementById('latitude').value = lat;
    document.getElementById('longitude').value = lng;
  }, err => alert('Location access denied or failed'));
});
</script>
{% endblock %}
